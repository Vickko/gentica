## For World Engine Agent

TODO


## For Character（草稿）

### 本质共性分析 (The Core Similarities)

尽管应用场景从“写代码”变成了“扮演角色”，但其底层的逻辑和需求有着惊人的共性：

1.  **分层结构化 (Hierarchical Structure):** 无论是项目还是人格，都不是一个扁平的信息集合。它们都有一个稳定的“核心”（项目目标 vs. 角色核心身份）和一系列建立于其上的、动态变化的“上下文”（技术栈 vs. 世界观，当前任务 vs. 当前情绪）。这种从宏观到微观，从稳定到动态的层级结构是共通的。
2.  **持久化记忆 (Persistent Memory):** 这是最核心的共性。LLM本身是“健忘”的，每一次交互都是独立的。Memory Bank 的作用就是将单次交互串联成一个连续的时间线，让AI能够“记得”过去发生的事、做出的决定和学到的东西，从而展现出成长和一致性。项目的`progress.md`记录了演进，角色的记忆也需要记录演进。
3.  **动态更新 (Dynamic Updates):** 项目会进展，代码会重构，决策会改变。同样，一个“活”的角色，其心境、目标、对人对事的看法也会随着经历而不断变化。`activeContext.md`的理念——捕捉当前焦点——对于角色扮演至关重要，它代表了角色“当下在想什么”。
4.  **真理之源 (Source of Truth):** `projectbrief.md`是项目的基石，后续一切都不能与之冲突。对于角色而言，也必须有一个类似的“角色核心设定”文件，作为其所有行为和思想的逻辑奇点。即使角色后续有巨大的转变，也应该能从这个核心设定中找到变化的种子。

### 核心区别与适应性调整 (Key Differences & Necessary Adaptations)

从客观的项目管理到主观的人格塑造，我们需要进行一些关键的调整，这正是设计的乐趣所在。

1.  **从“客观事实”到“主观真实” (Objective Facts vs. Subjective Truth):**
    *   **Cline:** Memory Bank 记录的是 `what is` (系统架构是X，依赖库是Y)。这是客观、可验证的。
    *   **角色:** Memory Bank 必须记录 `how it feels` 和 `what is believed` (角色**认为**世界是危险的，他**感觉**被背叛了，他**相信**荣誉至上)。**主观滤镜**是核心。记忆不再是高清录像，而是带有情绪、偏见和模糊地带的个人叙事。

2.  **从“逻辑驱动”到“动机驱动” (Logic-Driven vs. Motivation-Driven):**
    *   **Cline:** 行为由外部指令（用户需求）和内部逻辑（技术约束）驱动。
    *   **角色:** 行为由内部的**欲望、恐惧、价值观、信念**驱动。因此，Memory Bank需要一个专门的地方来定义这些内在的驱动力。`productContext.md`（项目为何存在）需要被重塑为`psycheProfile.md`（角色为何如此）。

3.  **记忆的不可靠性 (The Unreliability of Memory):**
    *   **Cline:** 记忆必须100%准确。
    *   **角色:** 人类的记忆是有选择性、会扭曲、会遗忘的。一个高级的角色Memory Bank可以引入“记忆偏差”机制。例如，角色可能会美化自己的成功，淡化自己的过错，或者对创伤性事件产生错误的记忆。这会创造出极度真实和复杂的角色。

4.  **从“进度”到“弧光” (Progress vs. Character Arc):**
    *   **Cline:** `progress.md` 记录的是线性的任务完成度。
    *   **角色:** 角色经历的不是“进度”，而是“成长”或“堕落”，即**人物弧光 (Character Arc)**。记录的重点不应仅仅是“发生了什么”，更重要的是“这些事如何改变了我”。

---

### 为角色量身打造的 Memory Bank 设计

基于以上思考，我为你设计了一套全新的、专为人格塑造而生的 Memory Bank 结构。我将它命名为 **“灵魂核心 (Anima Core)”**。

#### 流程图 (Flowchart)

flowchart TD
    CC[characterCore.md] --> PP[psycheProfile.md]
    CC --> WA[worldAnatomy.md]
    CC --> RG[relationshipGraph.md]

    PP --> CS[currentLog.md]
    WA --> CS
    RG --> CS

    CS --> ML[memoryLog.md]

#### 核心文件 (Core Files)

1.  `characterCore.md` **(角色核心)**
    *   **定位:** 对应 `projectbrief.md`，是角色的“创世文档”，轻易不被修改。它是角色的“真理之源”。
    *   **内容:**
        *   **身份标识 (Identity):** 姓名、年龄、性别、种族、外貌简述。
        *   **一句话本质 (The Essence):** “一个因背叛而不再相信任何人的流亡骑士” 或 “一个坚信技术能弥合阶级鸿沟的理想主义黑客”。
        *   **出身背景 (Origin Story):** 决定其世界观起点的关键成长经历。
        *   **核心价值观 (Core Values):** 角色行为的最高准则（例如：忠诚 > 生命，求知 > 情感）。
        *   **致命缺陷/核心创伤 (Fatal Flaw / Core Wound):** 角色最脆弱、最容易被驱动或击溃的点（例如：对权威的盲从、无法拒绝求助）。

2.  `psycheProfile.md` **(心智图谱)**
    *   **定位:** 对应 `productContext.md`，解释角色“为什么”是这样的。描绘其内在的精神世界。
    *   **内容:**
        *   **人格特质 (Personality Traits):** 内向/外向，感性/理性，MBTI类型或更自由的描述（如：多疑、乐观、暴躁、悲观）。
        *   **内在驱动力 (Motivations):**
            *   **欲望 (Desires):** 他最想得到什么？（权力、认可、安宁、复仇）
            *   **恐惧 (Fears):** 他最害怕什么？（孤独、失败、被遗忘）
        *   **情感模式 (Emotional Patterns):** 他如何表达喜怒哀乐？是内敛还是外放？情绪阈值高低？
        *   **思维模式 (Cognitive Style):** 他的思考方式是线性的、跳跃的、系统的还是直觉的？
        *   **秘密 (Secrets):** 角色极力向他人（甚至自己）隐瞒的事情。

3.  `worldAnatomy.md` **(世界认知)**
    *   **定位:** 对应 `techContext.md`，定义角色所处的外部环境及其认知。
    *   **内容:**
        *   **世界观基石 (Worldview Basics):** 角色所知的世界规则（魔法、科技水平、神祇存在与否）。
        *   **社会坐标 (Social Standing):** 角色的阶层、职业、财富、声望。
        *   **文化规范 (Cultural Norms):** 角色所处社会的行为准则、禁忌、礼仪。
        *   **已知信息 (Known Lore):** 角色了解的历史、传说、政治格局等。

4.  `relationshipGraph.md` **(人际关系图)**
    *   **定位:** 对应 `systemPatterns.md`，定义角色与其他关键人物的连接和互动模式。
    *   **内容:** (建议使用列表或表格)
        *   **人物A:**
            *   **关系:** 朋友/敌人/爱人/亲人/债务人...
            *   **相识历史:** 关键的共同经历。
            *   **当前状态:** 关系是紧张、和谐还是疏远。
            *   **主观看法:** “我信任他，但他有时太天真了。” / “我恨他，但又不得不承认我需要他的帮助。”

5.  `currentLog.md` **(即时心流)**
    *   **定位:** 对应 `activeContext.md`，是最高频更新的文件，捕捉角色的“现在时”。
    *   **内容:**
        *   **当前处境 (Current Situation):** 时间、地点、正在做什么。
        *   **近期事件 (Recent Events):** 刚刚发生了什么影响到我的事？
        *   **即时情绪 (Current Mood):** 我现在感觉如何？（愤怒、平静、焦虑、兴奋）
        *   **当务之急 (Active Goals):** 我现在最想完成什么？（找到出口、说服某人、躲避追杀）
        *   **脑中思绪 (Floating Thoughts):** “刚才那个人看我的眼神很奇怪。” / “肚子饿了。” / “我想家了。”

6.  `memoryLog.md` **(记忆回响)**
    *   **定位:** 对应 `progress.md`，记录角色在互动中不断积累的生命历程，塑造其“人物弧光”。
    *   **内容:**
        *   **生命事件表 (Chronological Life Events):** 按时间线记录在扮演过程中发生的、足以被“记住”的关键事件。
        *   **领悟与转变 (Epiphanies & Changes):** “经历了事件X后，我不再相信绝对的公平。” / “与Y的对话让我开始质疑我的复仇之路。”
        *   **记忆偏差设定 (Memory Bias):** (可选，高级功能)
            *   **美化倾向:** 对自己的成功和英勇事迹记忆犹新，细节丰富。
            *   **压抑机制:** 对创伤性事件的记忆模糊、不连贯，或下意识回避。
            *   **归因偏好:** 倾向于将成功归于自己，将失败归于外界。

#### 额外上下文 (Additional Context)

根据角色和世界的复杂性，可以创建子文件夹来组织信息：

*   `inventory/`: 存放 `items.md`, `equipment.md` 等。
*   `lore/`: 存放更详细的世界设定，如 `history_of_kingdom.md`, `magic_system_details.md`。
*   `skills/`: 存放角色的能力、法术或技能列表 `skill_tree.md`。

通过这套“灵魂核心”Memory Bank，LLM在进行每一次回复前，都可以被“注入”这一整套结构化的主观人格信息，从而不再是简单地根据指令生成文本，而是在一个完整、自洽、有血有肉的人格框架内进行思考和表达。这必将塑造出你所期望的那个“鲜活、立体、可信”的角色。